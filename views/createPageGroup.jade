extends  layout/base

block getTitle
    - var titleVar = "Create PageGroup"  

block append headCss
    link(rel="stylesheet" href="/assets/css/third-party/bootstrap-combobox.css")

block append headScripts
    script(src="/assets/js/libs/third-party/bootstrap-combobox.js")
    script.
        $(document).ready(function() {
            $('.combobox').combobox();

            function getDomain(url) {
                var a = document.createElement('a');
                a.href = url;
                return a.hostname;
            };

            function disableSampleUrlValidation() {
                $('#createPg').prop('disabled', false);
                $('#error-message').html('');   
            };

            function sampleUrlValidation(val) {
                if(val && (getDomain(val) !== getDomain('#{siteDomain}'))) {
                    $('#createPg').prop('disabled', true);
                    $('#error-message').html('The Sample URL should be from your website only');   
                }
                else {
                    disableSampleUrlValidation();
                }
            };

            $('#forceSampleUrl').on('change', function() {
                var val = $('#sampleUrl').val(),
                    sampleUrlForced = $(this).prop('checked');
                !sampleUrlForced ? sampleUrlValidation(val) : disableSampleUrlValidation();
            });

            $('#sampleUrl').on('keyup', function() {
                var val = $(this).val(),
                    sampleUrlForced = $('#forceSampleUrl').prop('checked');

                !sampleUrlForced ? sampleUrlValidation(val) : disableSampleUrlValidation();
            });
        });  

block bodyContent
    include layout/sideBar
    
    .pageContainer.page-container
        include layout/header

        // Page Content Starts Here
        .pageContentWrapper.page-content
            .pageContentInner.page-content--inner

                #widgetsArea.row
                    .mb-30
                        .controlAdpushupWrap
                            h3.title.m-All-0.clearfix
                                a.pull-left Create New PageGroup - 
                                    span!= utils.domanize(siteDomain)
                            form(method="post", action="createPagegroup")
                                input(type="hidden" value="#{siteId}" name="siteId")
                                .row.input-wrapper
                                    .col-sm-2
                                        label Page Group Name
                                    .col-sm-3
                                        if channels.length > 0
                                            select(class="combobox input-large form-control" name="pageGroupName")
                                                option(value="" selected="selected") Please enter Page Group Name  
                                                for channel in channels
                                                    option(value="#{channel}")!= channel    
                                        else 
                                            input.form-control(required, name="pageGroupName", type="text" placeholder="Please enter Page Group Name")
                                .row.input-wrapper
                                    .col-sm-2
                                        label Sample Url
                                    .col-sm-3
                                        input.form-control#sampleUrl(required, name="sampleUrl", type="url" placeholder="Please enter Sample Url") 
                                        .mT-10
                                            label.mR-5 Force Sample Url 
                                            input(type="checkbox" id="forceSampleUrl" name="forceSampleUrl")
                                .row.input-wrapper
                                    .col-sm-2
                                        label Device
                                    .col-sm-3
                                        .styleSelect
                                            select(required, name="device")
                                                option(value="") Select device
                                                option(value="desktop") Desktop
                                                option(value="tablet") Tablet
                                                option(value="mobile") Mobile
                                .row.input-wrapper
                                    .col-sm-4
                                        h3#error-message.error-message!= error
                                        button#createPg.btn.btn-lightBg.btn-default Create Page Group                                             
                                                                              
                                           