extends layout/base
block getTitle
    - var titleVar = utils.domanize(domain)

block headCss
    if environment == "production"
        +loadAsset("css", [
            //'//vjs.zencdn.net/4.12/video-js.css',
            '/assets/css/dataTables.css',
            '/assets/css/master.min.css'
        ])
    else
        link(href="/assets/css/editor/master.css", rel="stylesheet", type="text/css")

    +loadAsset("css", [
        '/assets/css/c3.css',
        //'//vjs.zencdn.net/4.12/video-js.css',
        '/assets/css/dataTables.css'
    ])

block append headScripts
    - isEnvironmentProduction = environment == "production";

    script(type="text/javascript").
        var currentUser = !{JSON.stringify(currentUser)},
            currentSiteId = !{JSON.stringify(currentSiteId)};
        window.ADP_BASEURL = "#{consts.BASE_URL}";
        window.ADP_ORIGIN = "#{consts.PROXY_ORIGIN}";
        window.ADP_SITE_DOMAIN = "#{domain}";
        window.ADP_SITE_ID = #{siteId};
        window.ADP_ENVIRONMENT = "#{environment}";
       
    if channels.length
        +loadAsset("js", [
            '/assets/js/react-15.js',
            '/assets/js/react-dom.js',
            //'//vjs.zencdn.net/4.12/video.js',
            //'/assets/js/builds/shim.js',
            // '/assets/js/underscore.js',
            //'/assets/js/lodash.js',
            '/assets/js/builds/outer.js'
        ])

    link(rel="chrome-webstore-item", href="https://chrome.google.com/webstore/detail/lbfaiagkagpgeefmnpefcibmpeccpjpi")

block append analyticsIdentify
    if environment == "production"
        script(type="text/javascript").
            setTimeout(function(){
                analytics.track('EDITOR_Open', {
                siteId: #{siteId ? siteId : null},
                siteDomain: '#{domain}',
                IS_ADMIN: #{isSuperUser}
                }, intercomObj);
            }, 1000);

block bodyContent
    if isChrome
        if channels.length
            .loaderwrapper.spinner(data-id='loader', style='display: block')
                img(src='/assets/images/loaderLogo.png')
            div(id='editor')   
        else
            .errorMain
                .container
                    .row
                        .col-sm-12
                            section.txt-ed.animated.In.fadeInDown
                                h4
                                    | No Page Group found!  Please create one to access the editor.
                                a(href="/user/site/#{siteId}/pagegroups") Create PageGroup
    else
        div(style='width:100%;height:100%;position: absolute;background:url(/public/assets/images/chrome-required.png) center center no-repeat;')
   